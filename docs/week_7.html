<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CASA0023 Learning Diary - Week 7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week_8.html" rel="next">
<link href="./week_6.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Week 7</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CASA0023 Learning Diary</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Week 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Week 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week_3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week_4.html" class="sidebar-item-text sidebar-link">Week 4</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week_5.html" class="sidebar-item-text sidebar-link">Week 5</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week_6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week 8</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week_7.html" class="sidebar-item-text sidebar-link active">Week 7</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week_8.html" class="sidebar-item-text sidebar-link">Week 8</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#application" id="toc-application" class="nav-link" data-scroll-target="#application">Application</a></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection">Reflection</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Week 7</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>This week we went through the following topics in the lecture and the practical:</p>
<ul>
<li><p>classification (continuing from the previous week)</p>
<ul>
<li>pre-classified data</li>
<li>Object-based image analysis</li>
<li>Sub pixel analysis</li>
</ul></li>
<li><p>accuracy assessment</p>
<ul>
<li>error matrix and kappa</li>
<li>The trade-off between recall and precision</li>
<li>F1, ROC curve</li>
<li>Spatial cross validation</li>
</ul></li>
</ul>
<p>For the summary, I would like to focus on the last topic of “spatial cross validation” in a Q&amp;A format, which is an important aspect to consider in the train-test split for classification methods as one of the ways to consider spatial autocorrelation.</p>
<p>What is Spatial Cross Validation?</p>
<ul>
<li>The usage of “spatial partitioning” using k-means clustering to split the observations (points or pixels) into subsets which are not spatially jointed <span class="citation" data-cites="brenning_rsaga_2018 lovelace_statistical_2023">(<a href="references.html#ref-brenning_rsaga_2018" role="doc-biblioref">Brenning, Bangs, and Becker 2018</a>; <a href="references.html#ref-lovelace_statistical_2023" role="doc-biblioref">Lovelace, Nowosad, and Muenchaw 2023</a>)</span></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/wk7_test_train.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Spatial Visualisation of testing and training observations for cross validation <span class="citation" data-cites="lovelace_statistical_2023">(<a href="references.html#ref-lovelace_statistical_2023" role="doc-biblioref">Lovelace, Nowosad, and Muenchaw 2023</a>)</span></figcaption><p></p>
</figure>
</div>
<p>Why is it problematic to use the conventional Cross Validation?</p>
<ul>
<li><p>Tobler’s first law of geography: “Everything is related to everything else, but near things are more related than distant things”</p></li>
<li><p>Conventional Cross Validation does not consider spatial autocorrelation between the training and testing points – training observations may hint what may be expected for testing observations, taking away the validity of the approach <span class="citation" data-cites="lovelace_statistical_2023">(<a href="references.html#ref-lovelace_statistical_2023" role="doc-biblioref">Lovelace, Nowosad, and Muenchaw 2023</a>)</span></p></li>
</ul>
<p>How does Spatial Cross Validation solve this issue?</p>
<ul>
<li><p>Bias-reduced assessment of the model’s predictive performance – avoids overfitting <span class="citation" data-cites="lovelace_statistical_2023">(<a href="references.html#ref-lovelace_statistical_2023" role="doc-biblioref">Lovelace, Nowosad, and Muenchaw 2023</a>)</span></p></li>
<li><p>spatially independent data are required for the estimation of unbiased predictive performance and to test generalization capabilities within the image <span class="citation" data-cites="lovelace_statistical_2023">(<a href="references.html#ref-lovelace_statistical_2023" role="doc-biblioref">Lovelace, Nowosad, and Muenchaw 2023</a>)</span></p></li>
</ul>
<p>How can this be used in classification using a support vector machine (SVM) model?</p>
<ul>
<li><p>“tuning” in SVM model <span class="citation" data-cites="gareth_introduction_2013">(<a href="references.html#ref-gareth_introduction_2013" role="doc-biblioref">Gareth et al. 2013</a>)</span></p>
<ul>
<li><p>looking for the best set of “hyperplanes” for the separation into different classes for classification</p></li>
<li><p>examining “kernels” with specific hyperparameters for the permission of non-linear boundaries between the different classes</p></li>
</ul></li>
<li><p>selection of the optimal hyperparameters using cross-validation methods - nested-spatial cross validation</p>
<ul>
<li><p>splitting each of the folds into a number of subfolds which are spatially disjointed and create models for each combination of the parameters <span class="citation" data-cites="lovelace_statistical_2023">(<a href="references.html#ref-lovelace_statistical_2023" role="doc-biblioref">Lovelace, Nowosad, and Muenchaw 2023</a>)</span></p>
<ul>
<li><p>parameter “c” <span class="citation" data-cites="yildirim_hyperparameter_2020">(<a href="references.html#ref-yildirim_hyperparameter_2020" role="doc-biblioref">Yildirim 2020</a>)</span></p>
<ul>
<li><p>considers the trade off between classifying the training data with high accuracy but low accuracy for the testing data, and avoiding overfitting for the training data but getting miss classified results</p></li>
<li><p>adds penalty for each point which is not correctly classified</p>
<ul>
<li><p>low value: selection of wide margin costing misclassifications</p></li>
<li><p>high value: attempt to minimise incorrectly classified observations using a smaller margin</p></li>
</ul></li>
</ul></li>
<li><p>parameter “Gamma” <span class="citation" data-cites="yildirim_hyperparameter_2020">(<a href="references.html#ref-yildirim_hyperparameter_2020" role="doc-biblioref">Yildirim 2020</a>)</span></p></li>
<li><p>Manages the distance of influence of a training point within the classified data</p>
<ul>
<li><p>Low value: large similarity radius – allows for more observations to be grouped together</p></li>
<li><p>High value: small similarity radius – observations need to be within a tightly bounded area to be classified in the same class, may lead to overfitting when value is extremely large</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/wk7_tuning.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Hyperparameter Tuning and Performance Estimation Levels in Cross Validation <span class="citation" data-cites="schratz2019">(<a href="references.html#ref-schratz2019" role="doc-biblioref">Schratz et al. 2019, 114</a>)</span></figcaption><p></p>
</figure>
</div>
<p>Are there any other ways with dealing with the same issue?</p>
<ul>
<li>Object-based, block-based, cluster-based, buffer-based partitioning <span class="citation" data-cites="karasiak_spatial_2022">(<a href="references.html#ref-karasiak_spatial_2022" role="doc-biblioref">Karasiak et al. 2022</a>)</span></li>
</ul>
<p>Are there any limitations of spatial cross validation</p>
<ul>
<li>Argument that spatial cross validation may lead to overly pessimistic results, leading to the underestimation of map results and probability sampling and design-based statistical inference should be used for accuracy assessment instead <span class="citation" data-cites="wadoux_spatial_2021">(<a href="references.html#ref-wadoux_spatial_2021" role="doc-biblioref">Wadoux et al. 2021</a>)</span></li>
</ul>
</section>
<section id="application" class="level2">
<h2 class="anchored" data-anchor-id="application">Application</h2>
<p>The question which arises is “how exactly can the usage of spatial cross validation influence the result for the context of remote sensing”. This can be considered with the study by Ploton et al. <span class="citation" data-cites="ploton_spatial_2020">(<a href="references.html#ref-ploton_spatial_2020" role="doc-biblioref">Ploton et al. 2020</a>)</span> reproduces works mapping aboveground biomass in central Africa (Gabon, Cameroon, Democratic Republic of Congo). Their interest in this topic arises from the fact that previous maps regarding aboveground biomass (AGB) used for the estimation of greenhouse gas emissions and the assessment the relationship between forest carbon and biodiversity, climate and land management pass overly contradict with maps which are produced at smaller scale with higher quality (ibid., p.2). This can be attributed to the spatial autocorrelation of the AGB data up to 120km and also of the environmental variables used for the modelling of AGB variation, demonstrating the violence of the independence of training and testing datasets (ibid., p.2).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/wk7_overview.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Study area and Field Data AGB <span class="citation" data-cites="ploton_spatial_2020">(<a href="references.html#ref-ploton_spatial_2020" role="doc-biblioref">Ploton et al. 2020</a>)</span></figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/wk7_spatial_autocorrelation.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Semivariogram of a) AGB and b) ABB predictors <span class="citation" data-cites="ploton_spatial_2020">(<a href="references.html#ref-ploton_spatial_2020" role="doc-biblioref">Ploton et al. 2020</a>)</span></figcaption><p></p>
</figure>
</div>
<p>They use the Random Forest Classification method to predict AGB in several countries – the data used in the classification are listed below</p>
<ul>
<li><p>Reference data</p>
<ul>
<li>Forget aboveground pixels – based on the Congo basin forest AGB, aggregated at the 1km spatial resolution, pixel exclusion to focus on the forested pixels with a solid level of canopy between 2000 and 2010 (period based on prediction variable of vegetation) and reliable pixel-level estimations of AGB – total of 28225 unique pixels</li>
</ul></li>
<li><p>Prediction (Independent) variable for classification</p>
<ul>
<li><p>Environmental data</p>
<ul>
<li><p>Worldclim2 database (1970-2000) – monthly average statistics of precipitation, temperature (T), solar radiation (SR), water vapor pressure (WP)</p></li>
<li><p>Global-PET database – monthly potential evapotranspiration (PET)</p></li>
<li><p>MODIS – statistics of annual cloud cover (CC) frequency</p></li>
</ul></li>
</ul></li>
<li><p>Vegetation data</p></li>
<li><p>MODIS Collection 6 (2000-2010) – stack of 8-day composite images at 1km spatial resolution</p>
<ul>
<li>Computation of reflectance mean and standard deviation layer for each band for the calculation of EVI2 and NDII vegetation indices &nbsp;</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/wk7_workflow.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Cross Validation Workflow <span class="citation" data-cites="ploton_spatial_2020">(<a href="references.html#ref-ploton_spatial_2020" role="doc-biblioref">Ploton et al. 2020</a>)</span></figcaption><p></p>
</figure>
</div>
<p>The above diagram demonstrates the flow of the methods employed to conduct this comparative analysis. They test three different types of cross-validation (cv) strategies: random k-fold (k=10) cv, spatial k-fold (k=44) cv, and buffered leave-one out cv. Here I will like to focus on the results of the first two strategies. The model based on random k-fold cv gives a R-squared value of 0.53, indicating that more than half of the variation of the observations may be accounted by this model. However, the model based on spatial k-fold value gives a R-squared value of 0.14, which is a much lower value. This indicates that that the random k-fold cv strategy is leading to overfitting, providing statistics which are more optimistic about the model’s predictive power than it should be, confining to what has been discussed in the summary.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/wk7_heatplot.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Heat plots of the relationship between observed AGB versus AGB predictions from (a) random k-fold CV and (b) spatial k-fold CV <span class="citation" data-cites="ploton_spatial_2020">(<a href="references.html#ref-ploton_spatial_2020" role="doc-biblioref">Ploton et al. 2020</a>)</span></figcaption><p></p>
</figure>
</div>
</section>
<section id="reflection" class="level2">
<h2 class="anchored" data-anchor-id="reflection">Reflection</h2>
<p>Despite learning about machine learning methods and cross validation in other modules, I was not familiar about the issues when employing the method in a spatial context, so it was sort of eye opening for me. Learning about spatial autocorrelation made me aware of the importance of having a critical eye on results I see in papers, on whether their approach has considered the issue of spatial autocorrelation when splitting the data into the testing data and training data. However, it was interesting to find scholars that spatial cross validation is not effective. I think this addresses the importance of considering different approaches and developing a better understanding of what the approach does well in and what may be the limitation in employing the specific method. Furthermore, as I was not able to delve into the results for the buffered leave-one out cv in the to develop a better understanding of how the issue can be considered.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-brenning_rsaga_2018" class="csl-entry" role="doc-biblioentry">
Brenning, Alexander, Donovan Bangs, and Mark Becker. 2018. <span>“<span>RSAGA</span>: <span>SAGA</span> <span>Geoprocessing</span> and <span>Terrain</span> <span>Analysis</span>.”</span> <a href="https://cran.r-project.org/web/packages/RSAGA/index.html">https://cran.r-project.org/web/packages/RSAGA/index.html</a>.
</div>
<div id="ref-gareth_introduction_2013" class="csl-entry" role="doc-biblioentry">
Gareth, James, Witten Daniela, Hastie Trevor, and Tibshirani Robert. 2013. <em>An Introduction to Statistical Learning: With Applications in <span>R</span></em>. Spinger.
</div>
<div id="ref-karasiak_spatial_2022" class="csl-entry" role="doc-biblioentry">
Karasiak, Nicolas, J-F Dejoux, Claude Monteil, and David Sheeren. 2022. <span>“Spatial Dependence Between Training and Test Sets: Another Pitfall of Classification Accuracy Assessment in Remote Sensing.”</span> <em>Machine Learning</em> 111 (7): 2715–40.
</div>
<div id="ref-lovelace_statistical_2023" class="csl-entry" role="doc-biblioentry">
Lovelace, Robin, Jacub Nowosad, and Jannes Muenchaw. 2023. <span>“Statistical <span>Learning</span>.”</span> <em>Geocomputation with R</em>. <a href="https://r.geocompx.org/spatial-cv.html">https://r.geocompx.org/spatial-cv.html</a>.
</div>
<div id="ref-ploton_spatial_2020" class="csl-entry" role="doc-biblioentry">
Ploton, Pierre, Frédéric Mortier, Maxime Réjou-Méchain, Nicolas Barbier, Nicolas Picard, Vivien Rossi, Carsten Dormann, et al. 2020. <span>“Spatial Validation Reveals Poor Predictive Performance of Large-Scale Ecological Mapping Models.”</span> <em>Nature Communications</em> 11 (1): 4540.
</div>
<div id="ref-schratz2019" class="csl-entry" role="doc-biblioentry">
Schratz, Patrick, Jannes Muenchow, Eugenia Iturritxa, Jakob Richter, and Alexander Brenning. 2019. <span>“Hyperparameter Tuning and Performance Assessment of Statistical and Machine-Learning Algorithms Using Spatial Data.”</span> <em>Ecological Modelling</em> 406 (August): 109–20. <a href="https://doi.org/10.1016/j.ecolmodel.2019.06.002">https://doi.org/10.1016/j.ecolmodel.2019.06.002</a>.
</div>
<div id="ref-wadoux_spatial_2021" class="csl-entry" role="doc-biblioentry">
Wadoux, Alexandre MJ-C, Gerard BM Heuvelink, Sytze De Bruin, and Dick J Brus. 2021. <span>“Spatial Cross-Validation Is Not the Right Way to Evaluate Map Accuracy.”</span> <em>Ecological Modelling</em> 457: 109692.
</div>
<div id="ref-yildirim_hyperparameter_2020" class="csl-entry" role="doc-biblioentry">
Yildirim, Soner. 2020. <span>“Hyperparameter <span>Tuning</span> for <span>Support</span> <span>Vector</span> <span>Machines</span> — <span>C</span> and <span>Gamma</span> <span>Parameters</span>.”</span> <em>Towards Data Science</em>. <a href="https://towardsdatascience.com/hyperparameter-tuning-for-support-vector-machines-c-and-gamma-parameters-6a5097416167">https://towardsdatascience.com/hyperparameter-tuning-for-support-vector-machines-c-and-gamma-parameters-6a5097416167</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week_6.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week 8</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week_8.html" class="pagination-link">
        <span class="nav-page-text">Week 8</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>